[build]
builder = "NIXPACKS"

[build.nixpacks]
installCmd = "cd client && npm ci && cd ../server && npm ci"
buildCmd = "cd client && npm run build && cd ../server && npx prisma generate && npm run build"

[deploy]
startCommand = "cd server && npx prisma migrate deploy && npm start"
healthcheckPath = "/api/health"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
